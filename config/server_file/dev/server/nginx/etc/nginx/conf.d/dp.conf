server {
        listen        443 ssl;
        server_name  dev.aiqingyinghang.com;

        ssl_certificate    /code_dir/config/server_file/dev/ssl/dev.aiqingyinghang.com.pem;
        ssl_certificate_key    /code_dir/config/server_file/dev/ssl/dev.aiqingyinghang.com.key;


	    root   /code_dir;
        index index.html;
#        location / {
#                try_files $uri $uri/ /index.html;
#        }
        location / {
            index index.php index.html error/index.html;

            if (!-e $request_filename){
				rewrite ^/index.php(.*)$ /index.php?s=$1 last;
				rewrite ^/(.*)$ /index.php?s=$1 last;
            }

            error_page 400 /error/400.html;
            error_page 403 /error/403.html;
            error_page 404 /error/404.html;
            error_page 500 /error/500.html;
            error_page 501 /error/501.html;
            error_page 502 /error/502.html;
            error_page 503 /error/503.html;
            error_page 504 /error/504.html;
            error_page 505 /error/505.html;
            error_page 506 /error/506.html;
            error_page 507 /error/507.html;
            error_page 509 /error/509.html;
            error_page 510 /error/510.html;
            autoindex  off;
        }
        location ~ \.php(.*)$ {
            fastcgi_pass   phpfpm8:9000;
            fastcgi_index  index.php;
            fastcgi_split_path_info  ^((?U).+\.php)(/?.+)$;
	        root   /code_dir;
            fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;
            fastcgi_param  PATH_INFO  $fastcgi_path_info;
            fastcgi_param  PATH_TRANSLATED  $document_root$fastcgi_path_info;
            include        fastcgi_params;
        }


	#禁止访问的文件或目录
    location ~ ^/(\.user.ini|\.htaccess|\.git|\.svn|\.project|LICENSE|README.md)
    {
        return 404;
    }

    #一键申请SSL证书验证目录相关设置
    location ~ \.well-known{
        allow all;
    }

    location ~ .*\.(gif|jpg|jpeg|png|bmp|swf)$
    {
        expires      30d;
        error_log /dev/null;
        access_log /dev/null;
    }

    location ~ .*\.(js|css)?$
    {
        expires      12h;
        error_log /dev/null;
        access_log /dev/null;
    }

}
